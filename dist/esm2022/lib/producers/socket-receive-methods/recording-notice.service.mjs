import { Injectable } from '@angular/core';
import * as i0 from "@angular/core";
import * as i1 from "../../methods/utils/sound-player.service";
export class RecordingNotice {
    SoundPlayerService;
    constructor(SoundPlayerService) {
        this.SoundPlayerService = SoundPlayerService;
    }
    /**
     * Handles the recording notice state and updates various recording parameters accordingly.
     *
     * @param {Object} options - The options object.
     * @param {string} options.state - The current state of the recording (e.g., "pause", "stop").
     * @param {Object} options.userRecordingParam - The user recording parameters.
     * @param {number} options.pauseCount - The count of pauses during the recording.
     * @param {number} options.timeDone - The elapsed time of the recording.
     * @param {Object} options.parameters - The parameters object containing various update functions and state variables.
     * @param {string} options.parameters.islevel - The level of the recording.
     * @param {Object} options.parameters.userRecordingParams - The user recording parameters.
     * @param {number} options.parameters.pauseRecordCount - The count of pauses during the recording.
     * @param {number} options.parameters.recordElapsedTime - The elapsed time of the recording.
     * @param {number} options.parameters.recordStartTime - The start time of the recording.
     * @param {boolean} options.parameters.recordStarted - Indicates if the recording has started.
     * @param {boolean} options.parameters.recordPaused - Indicates if the recording is paused.
     * @param {boolean} options.parameters.canLaunchRecord - Indicates if the recording can be launched.
     * @param {boolean} options.parameters.stopLaunchRecord - Indicates if the recording launch should be stopped.
     * @param {boolean} options.parameters.recordStopped - Indicates if the recording is stopped.
     * @param {boolean} options.parameters.isTimerRunning - Indicates if the timer is running.
     * @param {boolean} options.parameters.canPauseResume - Indicates if the recording can be paused or resumed.
     * @param {string} options.parameters.eventType - The type of event triggering the recording notice.
     * @param {Function} options.parameters.updateRecordingProgressTime - Function to update the recording progress time.
     * @param {Function} options.parameters.updateShowRecordButtons - Function to update the visibility of record buttons.
     * @param {Function} options.parameters.updateUserRecordingParams - Function to update user recording parameters.
     * @param {Function} options.parameters.updateRecordingMediaOptions - Function to update recording media options.
     * @param {Function} options.parameters.updateRecordingAudioOptions - Function to update recording audio options.
     * @param {Function} options.parameters.updateRecordingVideoOptions - Function to update recording video options.
     * @param {Function} options.parameters.updateRecordingVideoType - Function to update recording video type.
     * @param {Function} options.parameters.updateRecordingVideoOptimized - Function to update recording video optimization.
     * @param {Function} options.parameters.updateRecordingDisplayType - Function to update recording display type.
     * @param {Function} options.parameters.updateRecordingAddHLS - Function to update HLS addition in recording.
     * @param {Function} options.parameters.updateRecordingNameTags - Function to update recording name tags.
     * @param {Function} options.parameters.updateRecordingBackgroundColor - Function to update recording background color.
     * @param {Function} options.parameters.updateRecordingNameTagsColor - Function to update recording name tags color.
     * @param {Function} options.parameters.updateRecordingOrientationVideo - Function to update recording orientation video.
     * @param {Function} options.parameters.updateRecordingAddText - Function to update recording text addition.
     * @param {Function} options.parameters.updateRecordingCustomText - Function to update custom text in recording.
     * @param {Function} options.parameters.updateRecordingCustomTextPosition - Function to update custom text position.
     * @param {Function} options.parameters.updateRecordingCustomTextColor - Function to update custom text color.
     * @param {Function} options.parameters.updatePauseRecordCount - Function to update pause record count.
     * @param {Function} options.parameters.updateRecordElapsedTime - Function to update record elapsed time.
     * @param {Function} options.parameters.updateRecordStartTime - Function to update record start time.
     * @param {Function} options.parameters.updateRecordStarted - Function to update record started status.
     * @param {Function} options.parameters.updateRecordPaused - Function to update record paused status.
     * @param {Function} options.parameters.updateCanLaunchRecord - Function to update can launch record status.
     * @param {Function} options.parameters.updateStopLaunchRecord - Function to update stop launch record status.
     * @param {Function} options.parameters.updateRecordStopped - Function to update record stopped status.
     * @param {Function} options.parameters.updateIsTimerRunning - Function to update timer running status.
     * @param {Function} options.parameters.updateCanPauseResume - Function to update can pause/resume status.
     * @param {Function} options.parameters.updateRecordState - Function to update the record state.
     *
     * @returns {Promise<void>} A promise that resolves when the recording notice handling is complete.
     *
     * @throws {Error} Throws an error if handling the recording state and status fails.
     */
    RecordingNotice = async ({ state, userRecordingParam, pauseCount, timeDone, parameters, }) => {
        let { islevel, userRecordingParams, pauseRecordCount, recordElapsedTime, recordStartTime, recordStarted, recordPaused, canLaunchRecord, stopLaunchRecord, recordStopped, isTimerRunning, canPauseResume, eventType, updateRecordingProgressTime, updateShowRecordButtons, updateUserRecordingParams, updateRecordingMediaOptions, updateRecordingAudioOptions, updateRecordingVideoOptions, updateRecordingVideoType, updateRecordingVideoOptimized, updateRecordingDisplayType, updateRecordingAddHLS, updateRecordingNameTags, updateRecordingBackgroundColor, updateRecordingNameTagsColor, updateRecordingOrientationVideo, updateRecordingAddText, updateRecordingCustomText, updateRecordingCustomTextPosition, updateRecordingCustomTextColor, updatePauseRecordCount, updateRecordElapsedTime, updateRecordStartTime, updateRecordStarted, updateRecordPaused, updateCanLaunchRecord, updateStopLaunchRecord, updateRecordStopped, updateIsTimerRunning, updateCanPauseResume, updateRecordState, } = parameters;
        try {
            if (islevel !== '2') {
                if (state === 'pause') {
                    updateRecordStarted(true);
                    updateRecordPaused(true);
                    updateRecordState('yellow');
                    eventType !== 'broadcast' &&
                        this.SoundPlayerService.playSound({
                            soundUrl: 'https://www.mediasfu.com/sounds/record-paused.mp3',
                        });
                }
                else if (state === 'stop') {
                    updateRecordStarted(true);
                    updateRecordStopped(true);
                    updateRecordState('green');
                    eventType !== 'broadcast' &&
                        this.SoundPlayerService.playSound({
                            soundUrl: 'https://www.mediasfu.com/sounds/record-stopped.mp3',
                        });
                }
                else {
                    updateRecordState('red');
                    updateRecordStarted(true);
                    updateRecordPaused(false);
                    eventType !== 'broadcast' &&
                        this.SoundPlayerService.playSound({
                            soundUrl: 'https://www.mediasfu.com/sounds/record-progress.mp3',
                        });
                }
            }
            else {
                if (state === 'pause') {
                    updateRecordState('yellow');
                    if (userRecordingParam) {
                        userRecordingParams.mainSpecs = userRecordingParam.mainSpecs;
                        userRecordingParams.dispSpecs = userRecordingParam.dispSpecs;
                        userRecordingParams.textSpecs = userRecordingParam.textSpecs;
                        updateUserRecordingParams(userRecordingParams);
                        updateRecordingMediaOptions(userRecordingParams.mainSpecs.mediaOptions);
                        updateRecordingAudioOptions(userRecordingParams.mainSpecs.audioOptions);
                        updateRecordingVideoOptions(userRecordingParams.mainSpecs.videoOptions);
                        updateRecordingVideoType(userRecordingParams.mainSpecs.videoType);
                        updateRecordingVideoOptimized(userRecordingParams.mainSpecs.videoOptimized);
                        updateRecordingDisplayType(userRecordingParams.mainSpecs.recordingDisplayType);
                        updateRecordingAddHLS(userRecordingParams.mainSpecs.addHLS);
                        updateRecordingNameTags(userRecordingParams.dispSpecs.nameTags);
                        updateRecordingBackgroundColor(userRecordingParams.dispSpecs.backgroundColor);
                        updateRecordingNameTagsColor(userRecordingParams.dispSpecs.nameTagsColor);
                        updateRecordingOrientationVideo(userRecordingParams.dispSpecs.orientationVideo);
                        updateRecordingAddText(userRecordingParams.textSpecs?.addText ?? false);
                        updateRecordingCustomText(userRecordingParams.textSpecs?.customText ?? '');
                        updateRecordingCustomTextPosition(userRecordingParams.textSpecs?.customTextPosition ?? '');
                        updateRecordingCustomTextColor(userRecordingParams.textSpecs?.customTextColor ?? '');
                        pauseRecordCount = pauseCount;
                        updatePauseRecordCount(pauseRecordCount);
                        recordElapsedTime = timeDone;
                        recordElapsedTime = Math.floor(recordElapsedTime / 1000);
                        recordStartTime = Math.floor(Date.now() / 1000) - recordElapsedTime;
                        updateRecordStartTime(recordStartTime);
                        updateRecordElapsedTime(recordElapsedTime);
                        recordStarted = true;
                        recordPaused = true;
                        canLaunchRecord = false;
                        recordStopped = false;
                        updateRecordStarted(recordStarted);
                        updateRecordPaused(recordPaused);
                        updateCanLaunchRecord(canLaunchRecord);
                        updateRecordStopped(recordStopped);
                        updateShowRecordButtons(true);
                        isTimerRunning = false;
                        canPauseResume = true;
                        updateIsTimerRunning(isTimerRunning);
                        updateCanPauseResume(canPauseResume);
                        const formattedTime = this.formatElapsedTime(recordElapsedTime);
                        updateRecordingProgressTime(formattedTime);
                    }
                    this.SoundPlayerService.playSound({
                        soundUrl: 'https://www.mediasfu.com/sounds/record-paused.mp3',
                    });
                }
                else if (state === 'stop') {
                    updateRecordStarted(true);
                    updateRecordStopped(true);
                    canLaunchRecord = false;
                    stopLaunchRecord = true;
                    updateRecordStarted(recordStarted);
                    updateRecordStopped(recordStopped);
                    updateCanLaunchRecord(canLaunchRecord);
                    updateStopLaunchRecord(stopLaunchRecord);
                    updateShowRecordButtons(false);
                    updateRecordState('green');
                    this.SoundPlayerService.playSound({
                        soundUrl: 'https://www.mediasfu.com/sounds/record-stopped.mp3',
                    });
                }
                else {
                    updateRecordState('red');
                    updateRecordStarted(true);
                    updateRecordPaused(false);
                    this.SoundPlayerService.playSound({
                        soundUrl: 'https://www.mediasfu.com/sounds/record-progress.mp3',
                    });
                }
            }
        }
        catch (error) {
            console.log('Error in RecordingNotice: ', error);
            // throw new Error("Failed to handle recording state and status.");
        }
    };
    formatElapsedTime = (recordElapsedTime) => {
        const hours = Math.floor(recordElapsedTime / 3600);
        const minutes = Math.floor((recordElapsedTime % 3600) / 60);
        const seconds = recordElapsedTime % 60;
        return `${this.padNumber(hours)}:${this.padNumber(minutes)}:${this.padNumber(seconds)}`;
    };
    padNumber = (number) => {
        return number.toString().padStart(2, '0');
    };
    static ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.2.8", ngImport: i0, type: RecordingNotice, deps: [{ token: i1.SoundPlayer }], target: i0.ɵɵFactoryTarget.Injectable });
    static ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "18.2.8", ngImport: i0, type: RecordingNotice, providedIn: 'root' });
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.2.8", ngImport: i0, type: RecordingNotice, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }], ctorParameters: () => [{ type: i1.SoundPlayer }] });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjb3JkaW5nLW5vdGljZS5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vLi4vLi4vcHJvamVjdHMvbWVkaWFzZnUtYW5ndWxhci9zcmMvbGliL3Byb2R1Y2Vycy9zb2NrZXQtcmVjZWl2ZS1tZXRob2RzL3JlY29yZGluZy1ub3RpY2Uuc2VydmljZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDOzs7QUFtRTNDLE1BQU0sT0FBTyxlQUFlO0lBQ047SUFBcEIsWUFBb0Isa0JBQStCO1FBQS9CLHVCQUFrQixHQUFsQixrQkFBa0IsQ0FBYTtJQUFHLENBQUM7SUFFdkQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7T0F1REc7SUFDSCxlQUFlLEdBQUcsS0FBSyxFQUFFLEVBQ3ZCLEtBQUssRUFDTCxrQkFBa0IsRUFDbEIsVUFBVSxFQUNWLFFBQVEsRUFDUixVQUFVLEdBQ2EsRUFBaUIsRUFBRTtRQUMxQyxJQUFJLEVBQ0YsT0FBTyxFQUNQLG1CQUFtQixFQUNuQixnQkFBZ0IsRUFDaEIsaUJBQWlCLEVBQ2pCLGVBQWUsRUFDZixhQUFhLEVBQ2IsWUFBWSxFQUNaLGVBQWUsRUFDZixnQkFBZ0IsRUFDaEIsYUFBYSxFQUNiLGNBQWMsRUFDZCxjQUFjLEVBQ2QsU0FBUyxFQUVULDJCQUEyQixFQUMzQix1QkFBdUIsRUFDdkIseUJBQXlCLEVBQ3pCLDJCQUEyQixFQUMzQiwyQkFBMkIsRUFDM0IsMkJBQTJCLEVBQzNCLHdCQUF3QixFQUN4Qiw2QkFBNkIsRUFDN0IsMEJBQTBCLEVBQzFCLHFCQUFxQixFQUNyQix1QkFBdUIsRUFDdkIsOEJBQThCLEVBQzlCLDRCQUE0QixFQUM1QiwrQkFBK0IsRUFDL0Isc0JBQXNCLEVBQ3RCLHlCQUF5QixFQUN6QixpQ0FBaUMsRUFDakMsOEJBQThCLEVBQzlCLHNC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aW1wb3J0IHsgU291bmRQbGF5ZXIgfSBmcm9tICcuLi8uLi9tZXRob2RzL3V0aWxzL3NvdW5kLXBsYXllci5zZXJ2aWNlJztcblxuaW1wb3J0IHsgRXZlbnRUeXBlLCBVc2VyUmVjb3JkaW5nUGFyYW1zIH0gZnJvbSAnLi4vLi4vQHR5cGVzL3R5cGVzJztcblxuZXhwb3J0IGludGVyZmFjZSBSZWNvcmRpbmdOb3RpY2VQYXJhbWV0ZXJzIHtcbiAgaXNsZXZlbDogc3RyaW5nO1xuICB1c2VyUmVjb3JkaW5nUGFyYW1zOiBVc2VyUmVjb3JkaW5nUGFyYW1zO1xuICByZWNvcmRFbGFwc2VkVGltZTogbnVtYmVyO1xuICByZWNvcmRTdGFydFRpbWU6IG51bWJlcjtcbiAgcmVjb3JkU3RhcnRlZDogYm9vbGVhbjtcbiAgcmVjb3JkUGF1c2VkOiBib29sZWFuO1xuICBjYW5MYXVuY2hSZWNvcmQ6IGJvb2xlYW47XG4gIHN0b3BMYXVuY2hSZWNvcmQ6IGJvb2xlYW47XG4gIHJlY29yZFN0b3BwZWQ6IGJvb2xlYW47XG4gIGlzVGltZXJSdW5uaW5nOiBib29sZWFuO1xuICBjYW5QYXVzZVJlc3VtZTogYm9vbGVhbjtcbiAgZXZlbnRUeXBlOiBFdmVudFR5cGU7XG5cbiAgdXBkYXRlUmVjb3JkaW5nUHJvZ3Jlc3NUaW1lOiAodGltZTogc3RyaW5nKSA9PiB2b2lkO1xuICB1cGRhdGVTaG93UmVjb3JkQnV0dG9uczogKHNob3c6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHVwZGF0ZVVzZXJSZWNvcmRpbmdQYXJhbXM6IChwYXJhbXM6IFVzZXJSZWNvcmRpbmdQYXJhbXMpID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZGluZ01lZGlhT3B0aW9uczogKG9wdGlvbnM6IHN0cmluZykgPT4gdm9pZDtcbiAgdXBkYXRlUmVjb3JkaW5nQXVkaW9PcHRpb25zOiAob3B0aW9uczogc3RyaW5nKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdWaWRlb09wdGlvbnM6IChvcHRpb25zOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZGluZ1ZpZGVvVHlwZTogKHR5cGU6IHN0cmluZykgPT4gdm9pZDtcbiAgdXBkYXRlUmVjb3JkaW5nVmlkZW9PcHRpbWl6ZWQ6IChvcHRpbWl6ZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZGluZ0Rpc3BsYXlUeXBlOiAodHlwZTogJ3ZpZGVvJyB8ICdtZWRpYScgfCAnYWxsJykgPT4gdm9pZDtcbiAgdXBkYXRlUmVjb3JkaW5nQWRkSExTOiAoYWRkSExTOiBib29sZWFuKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdOYW1lVGFnczogKG5hbWVUYWdzOiBib29sZWFuKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdCYWNrZ3JvdW5kQ29sb3I6IChjb2xvcjogc3RyaW5nKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdOYW1lVGFnc0NvbG9yOiAoY29sb3I6IHN0cmluZykgPT4gdm9pZDtcbiAgdXBkYXRlUmVjb3JkaW5nT3JpZW50YXRpb25WaWRlbzogKG9yaWVudGF0aW9uOiBzdHJpbmcpID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZGluZ0FkZFRleHQ6IChhZGRUZXh0OiBib29sZWFuKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0OiAodGV4dDogc3RyaW5nKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0UG9zaXRpb246IChwb3NpdGlvbjogc3RyaW5nKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0Q29sb3I6IChjb2xvcjogc3RyaW5nKSA9PiB2b2lkO1xuICB1cGRhdGVQYXVzZVJlY29yZENvdW50OiAoY291bnQ6IG51bWJlcikgPT4gdm9pZDtcbiAgdXBkYXRlUmVjb3JkRWxhcHNlZFRpbWU6ICh0aW1lOiBudW1iZXIpID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZFN0YXJ0ZWQ6IChzdGFydGVkOiBib29sZWFuKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRQYXVzZWQ6IChwYXVzZWQ6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHVwZGF0ZUNhbkxhdW5jaFJlY29yZDogKGNhbkxhdW5jaDogYm9vbGVhbikgPT4gdm9pZDtcbiAgdXBkYXRlU3RvcExhdW5jaFJlY29yZDogKHN0b3A6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZFN0b3BwZWQ6IChzdG9wcGVkOiBib29sZWFuKSA9PiB2b2lkO1xuICB1cGRhdGVJc1RpbWVyUnVubmluZzogKHJ1bm5pbmc6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHVwZGF0ZUNhblBhdXNlUmVzdW1lOiAoY2FuUGF1c2U6IGJvb2xlYW4pID0+IHZvaWQ7XG4gIHVwZGF0ZVJlY29yZFN0YXJ0VGltZTogKHN0YXJ0VGltZTogbnVtYmVyKSA9PiB2b2lkO1xuICB1cGRhdGVSZWNvcmRTdGF0ZTogKHN0YXRlOiBzdHJpbmcpID0+IHZvaWQ7XG5cbiAgLy8gbWVkaWFzZnUgZnVuY3Rpb25zXG4gIFtrZXk6IHN0cmluZ106IGFueTtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBSZWNvcmRpbmdOb3RpY2VPcHRpb25zIHtcbiAgc3RhdGU6IHN0cmluZztcbiAgdXNlclJlY29yZGluZ1BhcmFtOiBVc2VyUmVjb3JkaW5nUGFyYW1zIHwgbnVsbDtcbiAgcGF1c2VDb3VudDogbnVtYmVyO1xuICB0aW1lRG9uZTogbnVtYmVyO1xuICBwYXJhbWV0ZXJzOiBSZWNvcmRpbmdOb3RpY2VQYXJhbWV0ZXJzO1xufVxuXG4vLyBFeHBvcnQgdGhlIHR5cGUgZGVmaW5pdGlvbiBmb3IgdGhlIGZ1bmN0aW9uXG5leHBvcnQgdHlwZSBSZWNvcmRpbmdOb3RpY2VUeXBlID0gKG9wdGlvbnM6IFJlY29yZGluZ05vdGljZU9wdGlvbnMpID0+IFByb21pc2U8dm9pZD47XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnLFxufSlcbmV4cG9ydCBjbGFzcyBSZWNvcmRpbmdOb3RpY2Uge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIFNvdW5kUGxheWVyU2VydmljZTogU291bmRQbGF5ZXIpIHt9XG5cbiAgLyoqXG4gICAqIEhhbmRsZXMgdGhlIHJlY29yZGluZyBub3RpY2Ugc3RhdGUgYW5kIHVwZGF0ZXMgdmFyaW91cyByZWNvcmRpbmcgcGFyYW1ldGVycyBhY2NvcmRpbmdseS5cbiAgICpcbiAgICogQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgLSBUaGUgb3B0aW9ucyBvYmplY3QuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnN0YXRlIC0gVGhlIGN1cnJlbnQgc3RhdGUgb2YgdGhlIHJlY29yZGluZyAoZS5nLiwgXCJwYXVzZVwiLCBcInN0b3BcIikuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLnVzZXJSZWNvcmRpbmdQYXJhbSAtIFRoZSB1c2VyIHJlY29yZGluZyBwYXJhbWV0ZXJzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5wYXVzZUNvdW50IC0gVGhlIGNvdW50IG9mIHBhdXNlcyBkdXJpbmcgdGhlIHJlY29yZGluZy5cbiAgICogQHBhcmFtIHtudW1iZXJ9IG9wdGlvbnMudGltZURvbmUgLSBUaGUgZWxhcHNlZCB0aW1lIG9mIHRoZSByZWNvcmRpbmcuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLnBhcmFtZXRlcnMgLSBUaGUgcGFyYW1ldGVycyBvYmplY3QgY29udGFpbmluZyB2YXJpb3VzIHVwZGF0ZSBmdW5jdGlvbnMgYW5kIHN0YXRlIHZhcmlhYmxlcy5cbiAgICogQHBhcmFtIHtzdHJpbmd9IG9wdGlvbnMucGFyYW1ldGVycy5pc2xldmVsIC0gVGhlIGxldmVsIG9mIHRoZSByZWNvcmRpbmcuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zLnBhcmFtZXRlcnMudXNlclJlY29yZGluZ1BhcmFtcyAtIFRoZSB1c2VyIHJlY29yZGluZyBwYXJhbWV0ZXJzLlxuICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnBhdXNlUmVjb3JkQ291bnQgLSBUaGUgY291bnQgb2YgcGF1c2VzIGR1cmluZyB0aGUgcmVjb3JkaW5nLlxuICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnJlY29yZEVsYXBzZWRUaW1lIC0gVGhlIGVsYXBzZWQgdGltZSBvZiB0aGUgcmVjb3JkaW5nLlxuICAgKiBAcGFyYW0ge251bWJlcn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnJlY29yZFN0YXJ0VGltZSAtIFRoZSBzdGFydCB0aW1lIG9mIHRoZSByZWNvcmRpbmcuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnJlY29yZFN0YXJ0ZWQgLSBJbmRpY2F0ZXMgaWYgdGhlIHJlY29yZGluZyBoYXMgc3RhcnRlZC5cbiAgICogQHBhcmFtIHtib29sZWFufSBvcHRpb25zLnBhcmFtZXRlcnMucmVjb3JkUGF1c2VkIC0gSW5kaWNhdGVzIGlmIHRoZSByZWNvcmRpbmcgaXMgcGF1c2VkLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMucGFyYW1ldGVycy5jYW5MYXVuY2hSZWNvcmQgLSBJbmRpY2F0ZXMgaWYgdGhlIHJlY29yZGluZyBjYW4gYmUgbGF1bmNoZWQuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnN0b3BMYXVuY2hSZWNvcmQgLSBJbmRpY2F0ZXMgaWYgdGhlIHJlY29yZGluZyBsYXVuY2ggc2hvdWxkIGJlIHN0b3BwZWQuXG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnJlY29yZFN0b3BwZWQgLSBJbmRpY2F0ZXMgaWYgdGhlIHJlY29yZGluZyBpcyBzdG9wcGVkLlxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IG9wdGlvbnMucGFyYW1ldGVycy5pc1RpbWVyUnVubmluZyAtIEluZGljYXRlcyBpZiB0aGUgdGltZXIgaXMgcnVubmluZy5cbiAgICogQHBhcmFtIHtib29sZWFufSBvcHRpb25zLnBhcmFtZXRlcnMuY2FuUGF1c2VSZXN1bWUgLSBJbmRpY2F0ZXMgaWYgdGhlIHJlY29yZGluZyBjYW4gYmUgcGF1c2VkIG9yIHJlc3VtZWQuXG4gICAqIEBwYXJhbSB7c3RyaW5nfSBvcHRpb25zLnBhcmFtZXRlcnMuZXZlbnRUeXBlIC0gVGhlIHR5cGUgb2YgZXZlbnQgdHJpZ2dlcmluZyB0aGUgcmVjb3JkaW5nIG5vdGljZS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZGluZ1Byb2dyZXNzVGltZSAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgcmVjb3JkaW5nIHByb2dyZXNzIHRpbWUuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVTaG93UmVjb3JkQnV0dG9ucyAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgdmlzaWJpbGl0eSBvZiByZWNvcmQgYnV0dG9ucy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVVzZXJSZWNvcmRpbmdQYXJhbXMgLSBGdW5jdGlvbiB0byB1cGRhdGUgdXNlciByZWNvcmRpbmcgcGFyYW1ldGVycy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZGluZ01lZGlhT3B0aW9ucyAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgbWVkaWEgb3B0aW9ucy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZGluZ0F1ZGlvT3B0aW9ucyAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgYXVkaW8gb3B0aW9ucy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZGluZ1ZpZGVvT3B0aW9ucyAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgdmlkZW8gb3B0aW9ucy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZGluZ1ZpZGVvVHlwZSAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgdmlkZW8gdHlwZS5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZGluZ1ZpZGVvT3B0aW1pemVkIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHJlY29yZGluZyB2aWRlbyBvcHRpbWl6YXRpb24uXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRpbmdEaXNwbGF5VHlwZSAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgZGlzcGxheSB0eXBlLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25zLnBhcmFtZXRlcnMudXBkYXRlUmVjb3JkaW5nQWRkSExTIC0gRnVuY3Rpb24gdG8gdXBkYXRlIEhMUyBhZGRpdGlvbiBpbiByZWNvcmRpbmcuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRpbmdOYW1lVGFncyAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgbmFtZSB0YWdzLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25zLnBhcmFtZXRlcnMudXBkYXRlUmVjb3JkaW5nQmFja2dyb3VuZENvbG9yIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHJlY29yZGluZyBiYWNrZ3JvdW5kIGNvbG9yLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25zLnBhcmFtZXRlcnMudXBkYXRlUmVjb3JkaW5nTmFtZVRhZ3NDb2xvciAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgbmFtZSB0YWdzIGNvbG9yLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25zLnBhcmFtZXRlcnMudXBkYXRlUmVjb3JkaW5nT3JpZW50YXRpb25WaWRlbyAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmRpbmcgb3JpZW50YXRpb24gdmlkZW8uXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRpbmdBZGRUZXh0IC0gRnVuY3Rpb24gdG8gdXBkYXRlIHJlY29yZGluZyB0ZXh0IGFkZGl0aW9uLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25zLnBhcmFtZXRlcnMudXBkYXRlUmVjb3JkaW5nQ3VzdG9tVGV4dCAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSBjdXN0b20gdGV4dCBpbiByZWNvcmRpbmcuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0UG9zaXRpb24gLSBGdW5jdGlvbiB0byB1cGRhdGUgY3VzdG9tIHRleHQgcG9zaXRpb24uXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0Q29sb3IgLSBGdW5jdGlvbiB0byB1cGRhdGUgY3VzdG9tIHRleHQgY29sb3IuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVQYXVzZVJlY29yZENvdW50IC0gRnVuY3Rpb24gdG8gdXBkYXRlIHBhdXNlIHJlY29yZCBjb3VudC5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZEVsYXBzZWRUaW1lIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHJlY29yZCBlbGFwc2VkIHRpbWUuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRTdGFydFRpbWUgLSBGdW5jdGlvbiB0byB1cGRhdGUgcmVjb3JkIHN0YXJ0IHRpbWUuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRTdGFydGVkIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHJlY29yZCBzdGFydGVkIHN0YXR1cy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZVJlY29yZFBhdXNlZCAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSByZWNvcmQgcGF1c2VkIHN0YXR1cy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZUNhbkxhdW5jaFJlY29yZCAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSBjYW4gbGF1bmNoIHJlY29yZCBzdGF0dXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVTdG9wTGF1bmNoUmVjb3JkIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHN0b3AgbGF1bmNoIHJlY29yZCBzdGF0dXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRTdG9wcGVkIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHJlY29yZCBzdG9wcGVkIHN0YXR1cy5cbiAgICogQHBhcmFtIHtGdW5jdGlvbn0gb3B0aW9ucy5wYXJhbWV0ZXJzLnVwZGF0ZUlzVGltZXJSdW5uaW5nIC0gRnVuY3Rpb24gdG8gdXBkYXRlIHRpbWVyIHJ1bm5pbmcgc3RhdHVzLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBvcHRpb25zLnBhcmFtZXRlcnMudXBkYXRlQ2FuUGF1c2VSZXN1bWUgLSBGdW5jdGlvbiB0byB1cGRhdGUgY2FuIHBhdXNlL3Jlc3VtZSBzdGF0dXMuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IG9wdGlvbnMucGFyYW1ldGVycy51cGRhdGVSZWNvcmRTdGF0ZSAtIEZ1bmN0aW9uIHRvIHVwZGF0ZSB0aGUgcmVjb3JkIHN0YXRlLlxuICAgKlxuICAgKiBAcmV0dXJucyB7UHJvbWlzZTx2b2lkPn0gQSBwcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgcmVjb3JkaW5nIG5vdGljZSBoYW5kbGluZyBpcyBjb21wbGV0ZS5cbiAgICpcbiAgICogQHRocm93cyB7RXJyb3J9IFRocm93cyBhbiBlcnJvciBpZiBoYW5kbGluZyB0aGUgcmVjb3JkaW5nIHN0YXRlIGFuZCBzdGF0dXMgZmFpbHMuXG4gICAqL1xuICBSZWNvcmRpbmdOb3RpY2UgPSBhc3luYyAoe1xuICAgIHN0YXRlLFxuICAgIHVzZXJSZWNvcmRpbmdQYXJhbSxcbiAgICBwYXVzZUNvdW50LFxuICAgIHRpbWVEb25lLFxuICAgIHBhcmFtZXRlcnMsXG4gIH06IFJlY29yZGluZ05vdGljZU9wdGlvbnMpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBsZXQge1xuICAgICAgaXNsZXZlbCxcbiAgICAgIHVzZXJSZWNvcmRpbmdQYXJhbXMsXG4gICAgICBwYXVzZVJlY29yZENvdW50LFxuICAgICAgcmVjb3JkRWxhcHNlZFRpbWUsXG4gICAgICByZWNvcmRTdGFydFRpbWUsXG4gICAgICByZWNvcmRTdGFydGVkLFxuICAgICAgcmVjb3JkUGF1c2VkLFxuICAgICAgY2FuTGF1bmNoUmVjb3JkLFxuICAgICAgc3RvcExhdW5jaFJlY29yZCxcbiAgICAgIHJlY29yZFN0b3BwZWQsXG4gICAgICBpc1RpbWVyUnVubmluZyxcbiAgICAgIGNhblBhdXNlUmVzdW1lLFxuICAgICAgZXZlbnRUeXBlLFxuXG4gICAgICB1cGRhdGVSZWNvcmRpbmdQcm9ncmVzc1RpbWUsXG4gICAgICB1cGRhdGVTaG93UmVjb3JkQnV0dG9ucyxcbiAgICAgIHVwZGF0ZVVzZXJSZWNvcmRpbmdQYXJhbXMsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdNZWRpYU9wdGlvbnMsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdBdWRpb09wdGlvbnMsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdWaWRlb09wdGlvbnMsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdWaWRlb1R5cGUsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdWaWRlb09wdGltaXplZCxcbiAgICAgIHVwZGF0ZVJlY29yZGluZ0Rpc3BsYXlUeXBlLFxuICAgICAgdXBkYXRlUmVjb3JkaW5nQWRkSExTLFxuICAgICAgdXBkYXRlUmVjb3JkaW5nTmFtZVRhZ3MsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdCYWNrZ3JvdW5kQ29sb3IsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdOYW1lVGFnc0NvbG9yLFxuICAgICAgdXBkYXRlUmVjb3JkaW5nT3JpZW50YXRpb25WaWRlbyxcbiAgICAgIHVwZGF0ZVJlY29yZGluZ0FkZFRleHQsXG4gICAgICB1cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0LFxuICAgICAgdXBkYXRlUmVjb3JkaW5nQ3VzdG9tVGV4dFBvc2l0aW9uLFxuICAgICAgdXBkYXRlUmVjb3JkaW5nQ3VzdG9tVGV4dENvbG9yLFxuICAgICAgdXBkYXRlUGF1c2VSZWNvcmRDb3VudCxcbiAgICAgIHVwZGF0ZVJlY29yZEVsYXBzZWRUaW1lLFxuICAgICAgdXBkYXRlUmVjb3JkU3RhcnRUaW1lLFxuICAgICAgdXBkYXRlUmVjb3JkU3RhcnRlZCxcbiAgICAgIHVwZGF0ZVJlY29yZFBhdXNlZCxcbiAgICAgIHVwZGF0ZUNhbkxhdW5jaFJlY29yZCxcbiAgICAgIHVwZGF0ZVN0b3BMYXVuY2hSZWNvcmQsXG4gICAgICB1cGRhdGVSZWNvcmRTdG9wcGVkLFxuICAgICAgdXBkYXRlSXNUaW1lclJ1bm5pbmcsXG4gICAgICB1cGRhdGVDYW5QYXVzZVJlc3VtZSxcbiAgICAgIHVwZGF0ZVJlY29yZFN0YXRlLFxuICAgIH0gPSBwYXJhbWV0ZXJzO1xuXG4gICAgdHJ5IHtcbiAgICAgIGlmIChpc2xldmVsICE9PSAnMicpIHtcbiAgICAgICAgaWYgKHN0YXRlID09PSAncGF1c2UnKSB7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhcnRlZCh0cnVlKTtcbiAgICAgICAgICB1cGRhdGVSZWNvcmRQYXVzZWQodHJ1ZSk7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhdGUoJ3llbGxvdycpO1xuICAgICAgICAgIGV2ZW50VHlwZSAhPT0gJ2Jyb2FkY2FzdCcgJiZcbiAgICAgICAgICAgIHRoaXMuU291bmRQbGF5ZXJTZXJ2aWNlLnBsYXlTb3VuZCh7XG4gICAgICAgICAgICAgIHNvdW5kVXJsOiAnaHR0cHM6Ly93d3cubWVkaWFzZnUuY29tL3NvdW5kcy9yZWNvcmQtcGF1c2VkLm1wMycsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ3N0b3AnKSB7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhcnRlZCh0cnVlKTtcbiAgICAgICAgICB1cGRhdGVSZWNvcmRTdG9wcGVkKHRydWUpO1xuICAgICAgICAgIHVwZGF0ZVJlY29yZFN0YXRlKCdncmVlbicpO1xuICAgICAgICAgIGV2ZW50VHlwZSAhPT0gJ2Jyb2FkY2FzdCcgJiZcbiAgICAgICAgICAgIHRoaXMuU291bmRQbGF5ZXJTZXJ2aWNlLnBsYXlTb3VuZCh7XG4gICAgICAgICAgICAgIHNvdW5kVXJsOiAnaHR0cHM6Ly93d3cubWVkaWFzZnUuY29tL3NvdW5kcy9yZWNvcmQtc3RvcHBlZC5tcDMnLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhdGUoJ3JlZCcpO1xuICAgICAgICAgIHVwZGF0ZVJlY29yZFN0YXJ0ZWQodHJ1ZSk7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkUGF1c2VkKGZhbHNlKTtcbiAgICAgICAgICBldmVudFR5cGUgIT09ICdicm9hZGNhc3QnICYmXG4gICAgICAgICAgICB0aGlzLlNvdW5kUGxheWVyU2VydmljZS5wbGF5U291bmQoe1xuICAgICAgICAgICAgICBzb3VuZFVybDogJ2h0dHBzOi8vd3d3Lm1lZGlhc2Z1LmNvbS9zb3VuZHMvcmVjb3JkLXByb2dyZXNzLm1wMycsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKHN0YXRlID09PSAncGF1c2UnKSB7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhdGUoJ3llbGxvdycpO1xuICAgICAgICAgIGlmICh1c2VyUmVjb3JkaW5nUGFyYW0pIHtcbiAgICAgICAgICAgIHVzZXJSZWNvcmRpbmdQYXJhbXMubWFpblNwZWNzID0gdXNlclJlY29yZGluZ1BhcmFtLm1haW5TcGVjcztcbiAgICAgICAgICAgIHVzZXJSZWNvcmRpbmdQYXJhbXMuZGlzcFNwZWNzID0gdXNlclJlY29yZGluZ1BhcmFtLmRpc3BTcGVjcztcbiAgICAgICAgICAgIHVzZXJSZWNvcmRpbmdQYXJhbXMudGV4dFNwZWNzID0gdXNlclJlY29yZGluZ1BhcmFtLnRleHRTcGVjcztcblxuICAgICAgICAgICAgdXBkYXRlVXNlclJlY29yZGluZ1BhcmFtcyh1c2VyUmVjb3JkaW5nUGFyYW1zKTtcbiAgICAgICAgICAgIHVwZGF0ZVJlY29yZGluZ01lZGlhT3B0aW9ucyh1c2VyUmVjb3JkaW5nUGFyYW1zLm1haW5TcGVjcy5tZWRpYU9wdGlvbnMpO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkaW5nQXVkaW9PcHRpb25zKHVzZXJSZWNvcmRpbmdQYXJhbXMubWFpblNwZWNzLmF1ZGlvT3B0aW9ucyk7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdWaWRlb09wdGlvbnModXNlclJlY29yZGluZ1BhcmFtcy5tYWluU3BlY3MudmlkZW9PcHRpb25zKTtcbiAgICAgICAgICAgIHVwZGF0ZVJlY29yZGluZ1ZpZGVvVHlwZSh1c2VyUmVjb3JkaW5nUGFyYW1zLm1haW5TcGVjcy52aWRlb1R5cGUpO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkaW5nVmlkZW9PcHRpbWl6ZWQodXNlclJlY29yZGluZ1BhcmFtcy5tYWluU3BlY3MudmlkZW9PcHRpbWl6ZWQpO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkaW5nRGlzcGxheVR5cGUodXNlclJlY29yZGluZ1BhcmFtcy5tYWluU3BlY3MucmVjb3JkaW5nRGlzcGxheVR5cGUpO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkaW5nQWRkSExTKHVzZXJSZWNvcmRpbmdQYXJhbXMubWFpblNwZWNzLmFkZEhMUyk7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdOYW1lVGFncyh1c2VyUmVjb3JkaW5nUGFyYW1zLmRpc3BTcGVjcy5uYW1lVGFncyk7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdCYWNrZ3JvdW5kQ29sb3IodXNlclJlY29yZGluZ1BhcmFtcy5kaXNwU3BlY3MuYmFja2dyb3VuZENvbG9yKTtcbiAgICAgICAgICAgIHVwZGF0ZVJlY29yZGluZ05hbWVUYWdzQ29sb3IodXNlclJlY29yZGluZ1BhcmFtcy5kaXNwU3BlY3MubmFtZVRhZ3NDb2xvcik7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdPcmllbnRhdGlvblZpZGVvKHVzZXJSZWNvcmRpbmdQYXJhbXMuZGlzcFNwZWNzLm9yaWVudGF0aW9uVmlkZW8pO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkaW5nQWRkVGV4dCh1c2VyUmVjb3JkaW5nUGFyYW1zLnRleHRTcGVjcz8uYWRkVGV4dCA/PyBmYWxzZSk7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0KHVzZXJSZWNvcmRpbmdQYXJhbXMudGV4dFNwZWNzPy5jdXN0b21UZXh0ID8/ICcnKTtcbiAgICAgICAgICAgIHVwZGF0ZVJlY29yZGluZ0N1c3RvbVRleHRQb3NpdGlvbihcbiAgICAgICAgICAgICAgdXNlclJlY29yZGluZ1BhcmFtcy50ZXh0U3BlY3M/LmN1c3RvbVRleHRQb3NpdGlvbiA/PyAnJyxcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRpbmdDdXN0b21UZXh0Q29sb3IodXNlclJlY29yZGluZ1BhcmFtcy50ZXh0U3BlY3M/LmN1c3RvbVRleHRDb2xvciA/PyAnJyk7XG5cbiAgICAgICAgICAgIHBhdXNlUmVjb3JkQ291bnQgPSBwYXVzZUNvdW50O1xuICAgICAgICAgICAgdXBkYXRlUGF1c2VSZWNvcmRDb3VudChwYXVzZVJlY29yZENvdW50KTtcblxuICAgICAgICAgICAgcmVjb3JkRWxhcHNlZFRpbWUgPSB0aW1lRG9uZTtcbiAgICAgICAgICAgIHJlY29yZEVsYXBzZWRUaW1lID0gTWF0aC5mbG9vcihyZWNvcmRFbGFwc2VkVGltZSAvIDEwMDApO1xuICAgICAgICAgICAgcmVjb3JkU3RhcnRUaW1lID0gTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMTAwMCkgLSByZWNvcmRFbGFwc2VkVGltZTtcbiAgICAgICAgICAgIHVwZGF0ZVJlY29yZFN0YXJ0VGltZShyZWNvcmRTdGFydFRpbWUpO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkRWxhcHNlZFRpbWUocmVjb3JkRWxhcHNlZFRpbWUpO1xuXG4gICAgICAgICAgICByZWNvcmRTdGFydGVkID0gdHJ1ZTtcbiAgICAgICAgICAgIHJlY29yZFBhdXNlZCA9IHRydWU7XG4gICAgICAgICAgICBjYW5MYXVuY2hSZWNvcmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHJlY29yZFN0b3BwZWQgPSBmYWxzZTtcblxuICAgICAgICAgICAgdXBkYXRlUmVjb3JkU3RhcnRlZChyZWNvcmRTdGFydGVkKTtcbiAgICAgICAgICAgIHVwZGF0ZVJlY29yZFBhdXNlZChyZWNvcmRQYXVzZWQpO1xuICAgICAgICAgICAgdXBkYXRlQ2FuTGF1bmNoUmVjb3JkKGNhbkxhdW5jaFJlY29yZCk7XG4gICAgICAgICAgICB1cGRhdGVSZWNvcmRTdG9wcGVkKHJlY29yZFN0b3BwZWQpO1xuICAgICAgICAgICAgdXBkYXRlU2hvd1JlY29yZEJ1dHRvbnModHJ1ZSk7XG5cbiAgICAgICAgICAgIGlzVGltZXJSdW5uaW5nID0gZmFsc2U7XG4gICAgICAgICAgICBjYW5QYXVzZVJlc3VtZSA9IHRydWU7XG5cbiAgICAgICAgICAgIHVwZGF0ZUlzVGltZXJSdW5uaW5nKGlzVGltZXJSdW5uaW5nKTtcbiAgICAgICAgICAgIHVwZGF0ZUNhblBhdXNlUmVzdW1lKGNhblBhdXNlUmVzdW1lKTtcblxuICAgICAgICAgICAgY29uc3QgZm9ybWF0dGVkVGltZSA9IHRoaXMuZm9ybWF0RWxhcHNlZFRpbWUocmVjb3JkRWxhcHNlZFRpbWUpO1xuICAgICAgICAgICAgdXBkYXRlUmVjb3JkaW5nUHJvZ3Jlc3NUaW1lKGZvcm1hdHRlZFRpbWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLlNvdW5kUGxheWVyU2VydmljZS5wbGF5U291bmQoe1xuICAgICAgICAgICAgc291bmRVcmw6ICdodHRwczovL3d3dy5tZWRpYXNmdS5jb20vc291bmRzL3JlY29yZC1wYXVzZWQubXAzJyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ3N0b3AnKSB7XG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhcnRlZCh0cnVlKTtcbiAgICAgICAgICB1cGRhdGVSZWNvcmRTdG9wcGVkKHRydWUpO1xuICAgICAgICAgIGNhbkxhdW5jaFJlY29yZCA9IGZhbHNlO1xuICAgICAgICAgIHN0b3BMYXVuY2hSZWNvcmQgPSB0cnVlO1xuXG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhcnRlZChyZWNvcmRTdGFydGVkKTtcbiAgICAgICAgICB1cGRhdGVSZWNvcmRTdG9wcGVkKHJlY29yZFN0b3BwZWQpO1xuICAgICAgICAgIHVwZGF0ZUNhbkxhdW5jaFJlY29yZChjYW5MYXVuY2hSZWNvcmQpO1xuICAgICAgICAgIHVwZGF0ZVN0b3BMYXVuY2hSZWNvcmQoc3RvcExhdW5jaFJlY29yZCk7XG4gICAgICAgICAgdXBkYXRlU2hvd1JlY29yZEJ1dHRvbnMoZmFsc2UpO1xuXG4gICAgICAgICAgdXBkYXRlUmVjb3JkU3RhdGUoJ2dyZWVuJyk7XG4gICAgICAgICAgdGhpcy5Tb3VuZFBsYXllclNlcnZpY2UucGxheVNvdW5kKHtcbiAgICAgICAgICAgIHNvdW5kVXJsOiAnaHR0cHM6Ly93d3cubWVkaWFzZnUuY29tL3NvdW5kcy9yZWNvcmQtc3RvcHBlZC5tcDMnLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHVwZGF0ZVJlY29yZFN0YXRlKCdyZWQnKTtcbiAgICAgICAgICB1cGRhdGVSZWNvcmRTdGFydGVkKHRydWUpO1xuICAgICAgICAgIHVwZGF0ZVJlY29yZFBhdXNlZChmYWxzZSk7XG4gICAgICAgICAgdGhpcy5Tb3VuZFBsYXllclNlcnZpY2UucGxheVNvdW5kKHtcbiAgICAgICAgICAgIHNvdW5kVXJsOiAnaHR0cHM6Ly93d3cubWVkaWFzZnUuY29tL3NvdW5kcy9yZWNvcmQtcHJvZ3Jlc3MubXAzJyxcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZygnRXJyb3IgaW4gUmVjb3JkaW5nTm90aWNlOiAnLCBlcnJvcik7XG4gICAgICAvLyB0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gaGFuZGxlIHJlY29yZGluZyBzdGF0ZSBhbmQgc3RhdHVzLlwiKTtcbiAgICB9XG4gIH07XG5cbiAgcHJpdmF0ZSBmb3JtYXRFbGFwc2VkVGltZSA9IChyZWNvcmRFbGFwc2VkVGltZTogbnVtYmVyKTogc3RyaW5nID0+IHtcbiAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3IocmVjb3JkRWxhcHNlZFRpbWUgLyAzNjAwKTtcbiAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcigocmVjb3JkRWxhcHNlZFRpbWUgJSAzNjAwKSAvIDYwKTtcbiAgICBjb25zdCBzZWNvbmRzID0gcmVjb3JkRWxhcHNlZFRpbWUgJSA2MDtcblxuICAgIHJldHVybiBgJHt0aGlzLnBhZE51bWJlcihob3Vycyl9OiR7dGhpcy5wYWROdW1iZXIobWludXRlcyl9OiR7dGhpcy5wYWROdW1iZXIoc2Vjb25kcyl9YDtcbiAgfTtcblxuICBwcml2YXRlIHBhZE51bWJlciA9IChudW1iZXI6IG51bWJlcik6IHN0cmluZyA9PiB7XG4gICAgcmV0dXJuIG51bWJlci50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7XG4gIH07XG59XG4iXX0=